# Ассистент по базам данных

## Описание. Целевой бизнес–процесс

ИИ–ассистент для эффективного взаимодействия с базами данных. 

Моментально предоставляет аналитику для руководителей и сотрудников, минимизирует необходимость обращения к аналитикам.

По вопросу пользователя и схеме базы данных генерирует SQL для получения нужной информации и исполняет его в базе данных.

## Устройство

Алгоритм:

- Получаем вопрос пользователя
- Составляем промпт для LLM из следующих компонентов:
    * Базовые инструкции, которые фреймят LLM на создание SQL.
    * Запрос пользователя.
    * Схему базы данных.
    * Кастомный промпт для тенанта, под которым авторизовался пользователь.
- Если в database_prediction_config для данного пользователя включена проверка наличия нужных колонок в БД, то с помощью LLM выполняется эта проверка.
    * Если в таблице недостаточно колонок для генерации ответа на вопрос пользователя, то на клиент отправляется сообщение об этом.
- Отправляет в LLM основной промпт для генерации SQL
- Исполняет SQL в базе данных МСУ.
- Ответ от LLM парсится и переводится в Markdown для удобного отображения в клиенте React.
- Если в database_prediction_config для данного пользователя включена генерация похожих вопросов, то происходит их генерация с помощью LLM.
- database_prediction_config для данного пользователя включена генерация описания созданного SQL, то происходит эта генерация
- Все ответы от LLM отправляются клиенту.

Промпт хранится во внутренней БД приложения в таблице prompt. 

В качестве LLM используется OpenAI GPT.